<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta charset="UTF-8" />
<title>Pizza AR Viewer</title>

<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

<style>
  body{
    margin:0;
    background:#fff;
    overflow:hidden;
  }

  model-viewer {
    width:100vw;
    height:100vh;
    position: relative;
    --progress-bar-color:#ff6400;
  }

  /* Progress Bar */
  .progress-bar {
    position:absolute;
    left:50%;
    bottom:12%;
    width:60%;
    max-width:300px;
    height:6px;
    background:rgba(0,0,0,0.12);
    transform:translateX(-50%);
    border-radius:4px;
    overflow:hidden;
    display:flex;
  }
  .update-bar {
    background:var(--progress-bar-color);
    width:0%;
    transition:width 0.2s;
  }
  .hide { display:none; }

  /* AR Button */
  #ar-button {
    background:black;
    color:white;
    border-radius:8px;
    border:none;
    position:absolute;
    bottom:4%;
    left:50%;
    transform:translateX(-50%);
    padding:12px 18px;
    font-size:16px;
    cursor:pointer;
    width:70%;
    max-width:260px;
  }

  /* AR Prompt */
  #ar-prompt {
    position:absolute;
    bottom:20%;
    left:50%;
    transform:translateX(-50%);
    display:none;
    animation:fadein 1.5s infinite alternate;
  }
  @keyframes fadein { from {opacity:0.2;} to {opacity:1;} }
</style>
</head>

<body>

<model-viewer id="viewer"
  src="0869c8ddd2bc40adbabe87203549ead5.glb"
  ios-src="0869c8ddd2bc40adbabe87203549ead5.usdz"
  ar
  ar-modes="webxr scene-viewer quick-look"
  camera-controls
  shadow-intensity="1"
  exposure="1.2">

  <!-- Progress -->
  <div class="progress-bar" slot="progress-bar">
    <div class="update-bar"></div>
  </div>

  <!-- AR Button -->
  <button slot="ar-button" id="ar-button">View in your space</button>

  <!-- AR Prompt -->
  <div id="ar-prompt">
    <img src="https://modelviewer.dev/shared-assets/icons/hand.png">
  </div>

</model-viewer>

<script>
const mv = document.querySelector('#viewer');
const progress = mv.querySelector('.progress-bar');
const bar = mv.querySelector('.update-bar');
const arPrompt = document.querySelector('#ar-prompt');

mv.addEventListener('progress', (e)=>{
  const p = e.detail.totalProgress * 100;
  bar.style.width = `${p}%`;
  if(p === 100){ progress.classList.add('hide'); }
});

mv.addEventListener('ar-status', (e)=>{
  if(e.detail.status === 'session-started'){
    arPrompt.style.display = 'block';
  } else {
    arPrompt.style.display = 'none';
  }
});
</script>

</body>
</html>
